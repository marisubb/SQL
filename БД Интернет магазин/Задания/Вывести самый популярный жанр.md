# Вывести самый популярный жанр

## Задание

Вывести жанр (или жанры), в котором было заказано больше всего экземпляров книг, указать это количество. Последний столбец назвать Количество.

## Фрагмент логической схемы базы данных

![cx8](https://github.com/user-attachments/assets/5c47d9e5-9217-4139-bdec-6a2f60e42662)


## Решение

```mysql
SELECT name_genre, SUM(buy_book.amount) AS Количество
FROM
    genre 
    INNER JOIN book ON genre.genre_id = book.genre_id
    INNER JOIN buy_book ON buy_book.book_id=book.book_id
GROUP BY name_genre
HAVING SUM(buy_book.amount) = (SELECT SUM(buy_book.amount) 
                                  FROM genre INNER JOIN book ON genre.genre_id = book.genre_id 
                                  INNER JOIN buy_book ON buy_book.book_id=book.book_id 
                                  GROUP BY name_genre 
                                  ORDER BY SUM(buy_book.amount) DESC 
                                  LIMIT 1);
```

## Результат

<img width="979" height="223" alt="2026-02-05_03-16-35" src="https://github.com/user-attachments/assets/85495eff-d017-408d-a428-8e1a5ea25663" />

